(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c6b202a"],{"1fe7":function(e,t,o){},"8a4b":function(e,t,o){"use strict";o("1fe7")},a291:function(e,t,o){"use strict";o.r(t);var r=o("7a23");Object(r["pushScopeId"])("data-v-8d014d0a");var l=Object(r["createElementVNode"])("h1",null,"添加新商品",-1);function n(e,t,o,n,c,a){var u=Object(r["resolveComponent"])("AddForm");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[l,Object(r["createVNode"])(u)],64)}Object(r["popScopeId"])();o("b0c0"),o("a4d3"),o("e01a");Object(r["pushScopeId"])("data-v-080ecbe2");var c=Object(r["createElementVNode"])("i",{class:"el-icon-plus"},null,-1),a=["src"],u=Object(r["createTextVNode"])("上传"),i=Object(r["createTextVNode"])("重置");function s(e,t,o,l,n,s){var d=Object(r["resolveComponent"])("el-upload"),m=Object(r["resolveComponent"])("el-dialog"),b=Object(r["resolveComponent"])("el-input"),p=Object(r["resolveComponent"])("el-form-item"),g=Object(r["resolveComponent"])("el-option"),f=Object(r["resolveComponent"])("el-select"),j=Object(r["resolveComponent"])("el-form"),O=Object(r["resolveComponent"])("el-button"),h=Object(r["resolveDirective"])("loading");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[Object(r["createVNode"])(d,{action:"#","list-type":"picture-card","file-list":n.fileList,"on-remove":s.handleRemove,"on-change":s.loadImg,"auto-upload":!1,"http-request":s.myupload,ref:"upload",class:"img-upload",limit:"1"},{default:Object(r["withCtx"])((function(){return[c]})),_:1},8,["file-list","on-remove","on-change","http-request"]),Object(r["createVNode"])(m,{modelValue:n.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.dialogVisible=e})},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("img",{width:"100%",src:n.dialogImageUrl,alt:""},null,8,a)]})),_:1},8,["modelValue"]),Object(r["createVNode"])(j,{model:n.ruleForm,rules:n.rules,ref:"ruleForm","label-width":"100px",class:"demo-ruleForm"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(p,{label:"商品名称",prop:"name"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(b,{modelValue:n.ruleForm.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return n.ruleForm.name=e})},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(p,{label:"商品简介",prop:"description"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(b,{modelValue:n.ruleForm.description,"onUpdate:modelValue":t[2]||(t[2]=function(e){return n.ruleForm.description=e})},null,8,["modelValue"])]})),_:1}),n.categories?(Object(r["openBlock"])(),Object(r["createBlock"])(p,{key:0,label:"商品类别",prop:"category"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(f,{modelValue:n.ruleForm.category,"onUpdate:modelValue":t[3]||(t[3]=function(e){return n.ruleForm.category=e}),placeholder:"请选择商品类别"},{default:Object(r["withCtx"])((function(){return[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(n.categories,(function(e,t){return Object(r["openBlock"])(),Object(r["createBlock"])(g,{key:t,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})):Object(r["createCommentVNode"])("",!0)]})),_:1},8,["model","rules"]),Object(r["withDirectives"])(Object(r["createVNode"])(O,{type:"primary",onClick:s.submitUpload,"element-loading-text":"上传中"},{default:Object(r["withCtx"])((function(){return[u]})),_:1},8,["onClick"]),[[h,n.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]]),Object(r["createVNode"])(O,{onClick:t[4]||(t[4]=function(e){return s.resetForm("ruleForm")})},{default:Object(r["withCtx"])((function(){return[i]})),_:1})],64)}Object(r["popScopeId"])();var d=o("4995"),m=o("c72e"),b=o.n(m),p={name:"addForm",data:function(){return{ruleForm:{name:"",description:"",category:"",img:null},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{message:"长度在 3 到 5 个字符",trigger:"blur"}],category:[{required:!0,message:"请选择商品类别",trigger:"change"}]},categories:["干货","特产","其他"],dialogImageUrl:"",dialogVisible:!1,fullscreenLoading:!1,fileList:[]}},methods:{handleRemove:function(e,t){console.log(e)},submitUpload:function(){this.$refs.upload.submit()},loadImg:function(e,t){console.log("handle img"),this.ruleForm.img=e.raw,console.log(this.ruleForm.img)},showSuccessMessage:function(e){Object(d["a"])({showClose:!0,type:"success",message:e})},showErrorMessage:function(e){Object(d["a"])({showClose:!0,type:"error",message:e})},myupload:function(){""!==this.ruleForm.name&&""!==this.ruleForm.category?(this.fullscreenLoading=!0,this.uploadObj()):this.showErrorMessage("信息不完整")},uploadObj:function(){var e=this,t=new b.a.File(this.ruleForm.img.name,this.ruleForm.img);t.save().then((function(t){console.log("图片保存完成。URL：".concat(t.url()));var o=b.a.Object.extend("item"),r=new o;r.set("name",e.ruleForm.name),r.set("description",e.ruleForm.description),r.set("category",e.ruleForm.category),r.add("img",t),r.save().then((function(t){e.showSuccessMessage("商品信息上传成功"),e.fullscreenLoading=!1,e.resetForm("ruleForm")}),(function(t){console.log(t),e.fullscreenLoading=!1,e.showErrorMessage("上传失败: "+t)}))}),(function(t){console.log(t),e.fullscreenLoading=!1,e.showErrorMessage("上传失败: "+t)}))},resetForm:function(e){this.$refs[e].resetFields(),this.fileList=[]}},created:function(){}},g=(o("de2a"),o("d959")),f=o.n(g);const j=f()(p,[["render",s],["__scopeId","data-v-080ecbe2"]]);var O=j,h={name:"addItem",components:{AddForm:O}};o("8a4b");const v=f()(h,[["render",n],["__scopeId","data-v-8d014d0a"]]);t["default"]=v},ae3c:function(e,t,o){},de2a:function(e,t,o){"use strict";o("ae3c")}}]);
//# sourceMappingURL=chunk-4c6b202a.0408acb7.js.map