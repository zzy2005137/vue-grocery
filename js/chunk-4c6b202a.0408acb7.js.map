{"version":3,"sources":["webpack:///./src/views/AddItem.vue?61d2","webpack:///./src/views/AddItem.vue","webpack:///./src/components/addForm.vue","webpack:///./src/components/addForm.vue?f27d","webpack:///./src/views/AddItem.vue?4f13","webpack:///./src/components/addForm.vue?fb11"],"names":["class","action","list-type","file-list","fileList","on-remove","handleRemove","on-change","loadImg","auto-upload","http-request","myupload","ref","limit","dialogVisible","width","src","dialogImageUrl","alt","model","ruleForm","rules","label-width","label","prop","name","description","categories","category","placeholder","index","key","value","type","submitUpload","element-loading-text","fullscreenLoading","resetForm","data","img","required","message","trigger","methods","file","console","log","this","$refs","upload","submit","raw","showSuccessMessage","msg","showClose","showErrorMessage","uploadObj","File","save","then","url","Item","Object","extend","localItem","set","add","res","error","resetFields","created","__exports__","components","AddForm","render"],"mappings":"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","file":"js/chunk-4c6b202a.0408acb7.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./AddItem.vue?vue&type=style&index=0&id=8d014d0a&scoped=true&lang=css\"","<template>\n  <h1>添加新商品</h1>\n  <AddForm />\n</template>\n\n<script>\nimport AddForm from \"@/components/addForm.vue\";\nexport default {\n  name: \"addItem\",\n  components: {\n    AddForm,\n  },\n};\n</script>\n\n<style scoped>\nh1 {\n  margin-top: 1rem;\n}\n</style>\n","<template>\n  <el-upload\n    action=\"#\"\n    list-type=\"picture-card\"\n    :file-list=\"fileList\"\n    :on-remove=\"handleRemove\"\n    :on-change=\"loadImg\"\n    :auto-upload=\"false\"\n    :http-request=\"myupload\"\n    ref=\"upload\"\n    class=\"img-upload\"\n    limit=\"1\"\n  >\n    <i class=\"el-icon-plus\"></i>\n  </el-upload>\n  <el-dialog v-model=\"dialogVisible\">\n    <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\" />\n  </el-dialog>\n\n  <el-form\n    :model=\"ruleForm\"\n    :rules=\"rules\"\n    ref=\"ruleForm\"\n    label-width=\"100px\"\n    class=\"demo-ruleForm\"\n  >\n    <el-form-item label=\"商品名称\" prop=\"name\">\n      <el-input v-model=\"ruleForm.name\"></el-input>\n    </el-form-item>\n    <el-form-item label=\"商品简介\" prop=\"description\">\n      <el-input v-model=\"ruleForm.description\"></el-input>\n    </el-form-item>\n    <el-form-item v-if=\"categories\" label=\"商品类别\" prop=\"category\">\n      <el-select v-model=\"ruleForm.category\" placeholder=\"请选择商品类别\">\n        <el-option\n          v-for=\"(category, index) in categories\"\n          :key=\"index\"\n          :label=\"category\"\n          :value=\"category\"\n        ></el-option>\n      </el-select>\n    </el-form-item>\n  </el-form>\n\n  <el-button\n    type=\"primary\"\n    @click=\"submitUpload\"\n    v-loading.fullscreen.lock=\"fullscreenLoading\"\n    element-loading-text=\"上传中\"\n    >上传</el-button\n  >\n\n  <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n</template>\n\n<script>\nimport { ElMessage } from \"element-plus\";\nimport AV from \"leancloud-storage\";\n\nexport default {\n  name: \"addForm\",\n  data() {\n    return {\n      ruleForm: {\n        name: \"\",\n        description: \"\",\n        category: \"\",\n        img: null,\n      },\n      rules: {\n        name: [\n          { required: true, message: \"请输入商品名称\", trigger: \"blur\" },\n          {\n            message: \"长度在 3 到 5 个字符\",\n            trigger: \"blur\",\n          },\n        ],\n        category: [\n          { required: true, message: \"请选择商品类别\", trigger: \"change\" },\n        ],\n      },\n\n      categories: [\"干货\", \"特产\", \"其他\"],\n      dialogImageUrl: \"\",\n      dialogVisible: false,\n      fullscreenLoading: false,\n      fileList: [],\n    };\n  },\n  methods: {\n    handleRemove(file, fileList) {\n      console.log(file);\n    },\n    submitUpload() {\n      //   trigger submit\n      this.$refs.upload.submit();\n    },\n    loadImg(file, fileList) {\n      console.log(\"handle img\");\n      this.ruleForm.img = file.raw;\n      console.log(this.ruleForm.img);\n      // fileList.forEach((element) => {\n      //   console.log(element.raw)\n      // })\n    },\n    showSuccessMessage(msg) {\n      ElMessage({\n        showClose: true,\n        type: \"success\",\n        message: msg,\n      });\n    },\n    showErrorMessage(msg) {\n      ElMessage({\n        showClose: true,\n        type: \"error\",\n        message: msg,\n      });\n    },\n    myupload() {\n      //验证表单\n      if (this.ruleForm.name === \"\" || this.ruleForm.category === \"\") {\n        this.showErrorMessage(\"信息不完整\");\n        return;\n      }\n\n      //屏幕锁定，上传中....\n      this.fullscreenLoading = true;\n      this.uploadObj();\n    },\n    uploadObj() {\n      const file = new AV.File(this.ruleForm.img.name, this.ruleForm.img);\n      file.save().then(\n        (file) => {\n          console.log(`图片保存完成。URL：${file.url()}`);\n\n          // 创建对象，关联已上传图片\n          const Item = AV.Object.extend(\"item\");\n          const localItem = new Item();\n          localItem.set(\"name\", this.ruleForm.name);\n          localItem.set(\"description\", this.ruleForm.description);\n          localItem.set(\"category\", this.ruleForm.category);\n          // attachments 是一个 Array 属性\n          localItem.add(\"img\", file);\n          localItem.save().then(\n            (res) => {\n              // 成功保存之后，执行其他逻辑\n              this.showSuccessMessage(`商品信息上传成功`);\n              this.fullscreenLoading = false;\n              this.resetForm(\"ruleForm\");\n            },\n            (error) => {\n              console.log(error);\n\n              this.fullscreenLoading = false;\n              this.showErrorMessage(\"上传失败: \" + error);\n\n              // 异常处理\n            }\n          );\n        },\n        (error) => {\n          // 保存失败，可能是文件无法被读取，或者上传过程中出现问题\n\n          console.log(error);\n          // this.showErrorMessage(\"上传失败，请重置后重试\")\n          this.fullscreenLoading = false;\n          this.showErrorMessage(\"上传失败: \" + error);\n        }\n      );\n    },\n\n    resetForm(ruleForm) {\n      this.$refs[ruleForm].resetFields();\n      this.fileList = [];\n    },\n  },\n  created() {},\n};\n</script>\n\n<style scoped>\n.img-upload {\n  margin: 2rem 0;\n}\n\n.img {\n  width: 10rem;\n  height: 10rem;\n  overflow: hidden;\n}\nimg {\n  width: 100%;\n}\n</style>\n","import { render } from \"./addForm.vue?vue&type=template&id=080ecbe2&scoped=true\"\nimport script from \"./addForm.vue?vue&type=script&lang=js\"\nexport * from \"./addForm.vue?vue&type=script&lang=js\"\n\nimport \"./addForm.vue?vue&type=style&index=0&id=080ecbe2&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\桌面\\\\学习\\\\vue\\\\vue-grocery\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-080ecbe2\"]])\n\nexport default __exports__","import { render } from \"./AddItem.vue?vue&type=template&id=8d014d0a&scoped=true\"\nimport script from \"./AddItem.vue?vue&type=script&lang=js\"\nexport * from \"./AddItem.vue?vue&type=script&lang=js\"\n\nimport \"./AddItem.vue?vue&type=style&index=0&id=8d014d0a&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\桌面\\\\学习\\\\vue\\\\vue-grocery\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8d014d0a\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./addForm.vue?vue&type=style&index=0&id=080ecbe2&scoped=true&lang=css\""],"sourceRoot":""}